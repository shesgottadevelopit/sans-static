# Project Log
The purpose of this document is to track my progress and document my process for creating a static site generator.


<!---
<details><summary>template for entries</summary>

### Entry No. 00x
Date: [insert dates]

**Notes:**
- [insert notes]

--------------------------------------

</details>
--->

## To-do list
- [ ] figure out a way to move other files not generated by gulp streams: https://coderwall.com/p/9uzttg/simple-gulp-copy-file-task
- [ ] clean up `templates` directory and files
- [ ] merge json files into a single file
- [ ] create a master site config file; url paths should be root relative
- [ ] super enhancement: Clean up URLs
- [ ] compile a single page and/or post
- [ ] copy producction ready files to `dist` and spin up a test server if needed, using those files

### Entry No. 016
Date: Thursday 4/18/2019

**Notes:**
Sooo I copied this function that opens Chrome in incognito mode.

```js
function (err, bs) { //opens the browser in incognito
require('opn')(bs.options.getIn(['urls', 'local']), {app: ['chrome', '--incognito']});
}
```

Added this to my `gulpfile.js` and it works! Found the solution in the issues section of the Browsersync [Github repo](https://github.com/BrowserSync/browser-sync/issues/1041).

Didn't update my log last night but I also figured out how to render an "archive" page, passing data within the stream. So I'm checking that off the list. I'd still like to figure out how to separate my tasks without breaking things.

Done done done!
- [x] Use Nunjucks/JSON to render an archive page/homepage (sorting articles by date)

Realized in the process that I don't need to store my data in the `build` directory. Still figuring that out too.

**Navigation**
I'm currently thinking about ways to generate a JS object or JSON file of pages that will appear in the top navigation and my pseudo codes goes:
- add an option in page frontmatter for "top-nav" and the value should either be true/false or yes/no
- if the value is true/yes, then I can check for that value with JS and pull that pages content into a JS object or JSON file, skipping over the other pages
- I can also add a "nav-sort" order and after the JS object or JSON file is completed, sort by that value

Ok so the last thing I've accomplished for today is that I've separated my front-matter extraction task from the rendering posts and pages tasks. I need to figure out a way to combine the different JSON files and then test out my navigation concept outlined above.

### Entry No. 015
Date: Wednesday 4/17/2019

**Notes:**
So this is what I landed on for sorting my array of posts. I added it to my gulpfile as a step right before I convert my JS object to a JSON file. Next I might want to break out some of my tasks, separation compilaton from data extraction - maybe?

```js
myPosts.sort(function (a,b){
    // return new Date(a.date).getTime() - new Date(b.date).getTime() // old to new
    return new Date(b.date).getTime() - new Date(a.date).getTime() // new to old
})

```
### Entry No. 014
Date: Tuesday 4/16/2019

**Notes:**
So one of the things that is next on my list is to sort my articles by date. I found some tricks for doing that thanks to Stackoverflow but I really wanted to figure out how sorting works so I did a dive into `Array.sort()`.

By default, the `sort` method sorts numbers and strings alphabetically and/or in ascending order (small to large). You have the ability to use a **comparison function** that will modify the type of sort the method will complete.

The `sort` method will change the original array - **FYI**.

This is some logic for for descending order sort:
```js

var artists = ['rihanna', 'beyonce', 'mary j', 'mariah', 'ella mai', 'meg the stallion'];

myArray.sort( function (a,b) { // you're always comparing two things so add those parameters in the function definition
    // the sort function body

    // If compare(a,b) is less than zero, the sort() method sorts 'a' to a lower index than 'b'.
    // ...  'a' will come first.
    // return -1

    // If compare(a,b) is greater than zero, the sort() method sort 'b' to 'a' lower index than 'a'
    // ... b will come first
    // return 1

    // If compare(a,b) returns zero, the sort() method considers a equals b and leaves their positions unchanged.
    // return 0
})
```

One interesting thing to note is that numbers are converted to strings when they're sorted. This affects how numbers end up sorted (likely not in correct order because it is not sorted based on it's numerical value).

Syntax for sorting numbers
```js
myNumberArray.sort(function (a,b) {
    // return a - b // ascending order
    // return b - a // descending order
})
```

One confusing thing to me when looking at the sort function and trying to decipher how it works is that it is not clear how the comparison function is implemented.

- So the `sort` method is a function that allows you to ... sort.
- Then you can add in a comparison function that dictates how the order in which the sort will occur (ascending, descending)
What is not apparent from any of these details is _how_ the comparison function proceeds with evaluating the Array items: in what order does it start, etc.

From there I did some Googling and found this explanation on [Treehouse](https://teamtreehouse.com/community/javascript-sort-method-how-does-the-comparison-actually-work). Basically the implementation of the comparison function depends on the the Browser or engine's preferred **sorting algorithm**. Apparently there is a long list of these algorithms, thanks to [Wikipedia](https://en.wikipedia.org/wiki/Sorting_algorithm).

Algorithms are... "a process or set of rules to be followed in calculations or other problem-solving operations, especially by a computer." So in this case, they are the rules by which the sort comparison function are applied to each array.

Another way of putting it is that they're "guidelines that describe how to perform [the task of sorting using the order specified in the comparison function"](http://www.slate.com/articles/technology/future_tense/2016/02/what_is_an_algorithm_an_explainer.html).

It's making more sense to me now. Now while I may be able to `console.log` to see what items in my array are being evaluated, there is a chance that the rules for how these items are picked will not be easily accessible via `console.log`.

Anyway, for my project, what I'll need to do is something like:
```js

var mysortedList = myPosts.sort(function (a,b) {
    return new Date(a.date) - new Date(b.date)
})

```
I'll have to use the Date object because the sort function converts all values to strings by default so it won't correctly sort my posts by their date (oldest - newest or vice versa) without using the Date object to preserve the dates and accurately compare two dates, versus comparing two strings formerly known as dates.


### Entry No. 013
Date: Saturday 4/13/2019

**Notes:**
Finished a to-do:
- [x] create a way to clean out `build ` before recompiling and moving files for each default gulp task

Whenever I run `gulp` in this project, it will delete either the entire `build` directory or just remove all the files within it. This way it is fresh each time. I will explore ways to only rebuild the new stuff at some point but I like this. I found my answer to this problem on [stackoverflow](https://stackoverflow.com/questions/37599280/gulp-how-to-delete-build-directory-before-running-other-tasks), of course.


### Entry No. 012
Date: Friday 04/12/2019

**Notes:**
I've definitely slowed down in working on this but making incremental changes. Last week I started the process of separating source files in `src` from build files in `build`, to clean up the directory structure. When I did that, it made it so that browserSync no longer loaded from the correct path, especially since I'm using a virtual host.

**Solution**
To address that, in my Apache `httpd-vhosts.conf` I updated the `Document Root` and `Directory` path so that it points to the root project directory and not my `src` folder.

```bash
DocumentRoot c:/.../pink-lemonade/sans-base/ # previously was c:/.../pink-lemonade/sans-base/src
<Directory  "c:/.../pink-lemonade/sans-base/" # previously was "c:/.../pink-lemonade/sans-base/src"
```

I then played around with some of BrowserSync's options available in the documentation.

Because I need to run multiple instances of BrowserSync, I needed to readjust my gulpfile to account for that. Before I had `var browserSync = require('browser-sync').create();`. That needed to be replaced by:

```js
var bs = browserSync.create()
var bsProduction = browserSync.create()

gulp.task('browser-sync', function() {
    // stream things
});
```

Because I renamed the variables I'll also need to replace any references to the old, singular BrowserSync instance labeled `browserSync` w/ `bs`, especially for lines like this: `.pipe(bs.reload({stream: true}));`

Inside my gulp task for initiating this BrowserSync instance, the only thing I added was this block of code to that serves up the static files in a specific directory. This happens to work because this is a static site generator, so the files are being copied to a directory. If I make changes in my `src`, BrowserSync is watching them, processing it from `src` to `build`, and then reloading the browsers using the newly regenerated files in `build`.

```js
serveStatic: [{
    dir: 'build' //src --> build
}]
```

And that's it. I'll need to set up the production one at some point but things are looking good now.

### Entry No. 011
Date: Saturday 04/06/2019

**Notes:**
I updated the output directory for `.pipe(gulp.dest(''))` so that it would be `build` instead of `src`. That way I can really keep source and final materials separate. I have another directory call `dist` which will likely be more production-ready focused and included minified, prettified stuff, but that is a task for later.

I also added this line of code so create a `build/data` directory for my json files. I likely won't need it if I create a task for moving any json file in `src` to `build` but I'm glad google gave me that solution really quickly. Unlike gulp, the `fs` module doesn't automatically create a directory if it doesn't exist.

```js
if (!fs.existsSync('build/data')){
    fs.mkdirSync('build/data')
}
```
Other than that, I think I'm getting closer to a ready to work with workflow soon. Going to start cleaning up my readme and also pull in my todo's to this document since it is probably easier to track.

### Entry No. 010
Date: Friday 04/05/2019

**Up Next:**
Might try this `gulp-markdown-to-json` plugin which I think probably would've solved the problem I spent all day fixing. https://github.com/sparkartgroup/gulp-markdown-to-json#readme

**Helper function:** I created this helper function so that I won't have to constantly type it out whenever I'm trying to log data to the console for debugging

```js
//Before
.pipe(gulpData(function(file) {
    var content = matter(file.contents);
    console.log(content)
    console.log(file.data)
    // console.log(fm)
    // console.log(file.extract)
}))

//After
function logData(file) {
    var contents = matter(file.contents)
    console.log(file);
    console.log(file.data);
    console.log(contents)
}

// Call in in the gulp task like this:
.pipe(gulpData(logData))

```

**Notes:**
New developments: while trying to go to sleep I decided to google and figure out if there is a way to add content to a file. I'm thinking this way I could insert `{% extends template.nunjucks %}` into my Markdown files for posts without having that in the actual document. And I'll do this after the frontmatter has already be extracted and saved to a JSON file, ideally.

Thanks again to stackoverflow, there are a few options for type of solution:
- `gulp-header`
- `gulp-replace`
- `map-stream` which I'd like to explore later

For this project I'm going to go for what seems like the simple solution which is `gulp-header`.

I'm also going to create a new branch on git to test this out to avoid the issue I had yesterday with code changes I couldn't track :-).

Git branching refresher for me:
```bash
git checkout -b <branch name> # creates and switches you to this new branch

git checkout master # switches back to master
```
The thing I thought would happen w/using `gulp-header` is happening. It is wrapping the whole document, including frontmatter with the tags, which means the frontmatter now gets rendered to the page as HTML.

Options include:
- figuring out how to extract frontmatter from the top while it is going through the stream
- use another plugin. Found `gulp-inject-string` but that would require me to add markup to the page as a separator or use the existing markup and hope nothing in the middle conflicts in the future
- See about `gulp-replace`

**Update:** turns out there is a gulp plugin that does option no.1 and I completely overlooked it thinking it functioned just like gray-matter and why would I need two of those. I spent alot of time today trying Regex my way out of this situation and someone else had already done the heavy lifting _sighs_. That plugin is called `gulp-front-matter`.

Some of the things I explored are below:

- tinkered with updating the `gulp-extract-text` plugin. It extracted the text but I still couldn't figure out how to take the text out of the document while in the file stream.
- `gulp-replace` was not working
- `gulp-inject-string`'s wrap functionality would be great but I couldn't figure out how to isolate just the body text without including the frontmatter. I may be able to use that now that `gulp-front-matter` is doing the isolating.

Code dump:
```js

const extract = require('../gulp-extract-text/app/index');

// .pipe(extract(extract_params))
.pipe(gulpData(function(file) {
    var content = matter(file.contents);
    //console.log(content)
    //console.log(file.extract)
    // fm = matter(file.extract)
    // console.log(fm)
    // fm = '---'+file.extract+'---'
    fm = file.extract
    console.log(fm)
    console.log(typeof fm)
    console.log(content)
}))

// add extends for templating: {% extends "post.nunjucks" %}
// .pipe(gulpReplace(fm, 'nothing'))
// .pipe(gulpInject.before(fm, ''))
// .pipe(gulpInject.after(fm,'this thing'))
.pipe(gulpHeader('{% extends "post.nunjucks" %} \n {% block content %}'))
.pipe(gulpFooter('{% endblock %}'))
// .pipe(gulpInject.wrap('{% extends "post.nunjucks" %} \n {% block content %}', '{% endblock %}'))
// .pipe(gulpInject.after(fm+'---', '{% extends "post.nunjucks" %} \n {% block content %}'))
// .pipe(gulpInject.after('---\n', `INJECTED TEXT`))
// .pipe(gulpFooter('{% endblock %}'))
```

### Entry No. 009
Date: Thursday 04/04/2019

**Notes:**
Soooo I started to figure out my posts rendering script and then noticed that my regular nunjucks script stopped working. I'm not sure how to fix that. I decided to open another project created in nunjucks to see if it was working and yes all of the files are compiling. It is just this project I've been working on for the last few days that is no longer compiling after I found success yesterday URGHHH!

I ended up cloning my github repo (thank goodness!) to a new directory, since that code wasn't broken. I found out the issue was that `gulp-gray-matter` wasn't extracting frontmatter from my Markdown files, only Nunjucks. I wasn't sure how to extract frontmatter using only the `gray-matter` package but thanks to Stackoverflow I was able to find a "recipe" to model mine after. Not exactly the same but I figured out how to make it work.

Stackoverflow fix: https://stackoverflow.com/questions/40414310/gulp-control-output-based-on-data-from-an-earlier-pipe

Now I need to figure out how to get my updated code into this and hope this one actually starts working again.

**Update:** It is fixed, I copied my old code into my new code. After looking over each line and trying to fix it without copying, I wasn't able to find my mistake, so copying will do. Going to push these changes and call it a night before I break something else. Going to do a git branch refresher so I'm not making this mistake again.

Also made my css directory path root relative since the template hierachy makes it challenge to get the right path for pages in `articles` versus the site root. Thanks to stackoverflow again for this [tip](https://github.com/mozilla/nunjucks/issues/1056#issuecomment-360531108).

### Entry No. 008
Date: Wednesday 04/03/2019

**Next Steps:**
- For posts consider this: http://assemble.io/docs/YAML-front-matter.html

Update pseudocode:
```js
// page compilation | .md --> nunjucks --> html
    // starting with the posts.nunjucks template
    // grab each markdown file from the posts directory, each file in the stream will be labeled "file"
    // pipe each markdown file into the posts.njk template through the {%markdown filename.md %} block
    // render html file
    // generate a list of the articles and there pertinent front matter into a JSON file: title of the post, date, and url
    // use the json to create an archive sorted
```

**Notes:**
So far, I'm using `gulp-data` to access the frontmatter and I'm extracting it into an object and pushing that object to an array. This is the code:
```js

var myList = [];

// .... other plugins

.pipe(gulpData(function(file) {
        var content = matter(file.contents);
        //console.log(file)
        console.log(file.path);
        console.log(Object.getOwnPropertyNames(file));
        //console.log(file.contents)
        //console.log(content)
        var singleFile = {
            "title": file.data.title,
            "description": file.data.description,
            "content": content.content
        }
        // var singleFile = file.data;

        myList.push(singleFile);

    }))
.on('end', function(){
    console.log(myList)
})

```
I need to figure out how to push to an object, convert that object to JSON format and save as a JSON file in my `src/data` setup. One thing to note is right now I'm testing this with pages and not posts since I haven't figure out my post rendering situation. **Success!**

I figured out how to do it using `fs.writeFileSync`. There is a gulp plugin that offers the same functionality and I'll look into that at some point. It is called `jsonfile` and is on [npm](https://www.npmjs.com/package/jsonfile).

Thinking ahead, I could separate this part of the compilation task and make a dedicated data task.

### Entry No. 007
Date: Tuesday 04/02/2019

**Notes:**
I've spent the last two day trying to figure out how to extract the data in the files that are moving through the node streams.

I think I'm closer but not quite so I'm taking a step back to read up on stream. I also just need to start trying and stop reading but we'll get there.

Basically, I want to be able to store some of the frontmatter into a JSON file and/or variable so that I can use it as data in nunjucks templates and later in nunjucks templates for archive pages.

Some pseudocode follows:
```js
// page compilation | .md --> nunjucks --> html
    // read the files in posts and generate a list with the filename that is saved to the directory as a JSON file (same as the last one but this happens before)
        // this list should include the title of the post, date, and url
    // create a posts object in the system
        // for each file, store the frontmatter as an object inside the posts object
        // save that posts object to a new variable call that can be used by the rest of the task
    // for each post in the posts directory, gulp will render the post, inserting the filename into the {%markdown block%} and generating an html page. the file will be generated using variables pulled from greymatter . it will use the "post" template
    // store that post in 'src/articles'
    // write a json file that includes the list of files in that directory w/url as an archive
```

My success so far is being able to render data from a JSON file stored in my project within the nunjucks template. Now I have to figure out how to create/extract data from the markdown files frontmatter and pass that into nunjucks later to render templates.

**Update:** I figured out how to access the `file.data` object/property for each file in the stream using this code after the gulpGrayMatter task

```js
.pipe(gulpData(function(file) {
        console.log(file.data);
    }))
```

What I need to do next is figure out how to save that data and also prevent that "Buffer 05 03 38" thing from happening. I got the hint from this [stackoverflow post](https://stackoverflow.com/questions/36560482/where-is-gulp-front-matter-putting-my-front-matter) which explains that plugin creators assume the user will use `gulp-data` to manipulate the data, although it seems clear to me that the data is accessible even without using `gulp-data`.

### Entry No. 006
Date: Friday 03/29/2019

**Notes:**
I'm so glad I was able to wrap up that tasks for rendering Markdown and Nunjucks at once. I will definitely circle back to better understand `.bind` and why what I was doing wasn't working.

#### Frontmatter
Next thing I'll focus on is figuring out how to set up a global config file and using front-matter... and figuring out why I'm even doing that. It just keeps coming up in my research.
- Figure out the correct way to format front matter based on whatever data format I decide on
- Update my test post markdown file using that correct format
- Write the function for doing whatever I need to do to insert frontmatter from that page into my HTML markup

#### Markdown post compilation - automated
The other thing I want to do is think of an easy way to compile posts. While I'll have pages that will mostly using the `.nunjucks` extension. Something like:
- Create a post in `templates/posts`, this will always have a `.md` extension.
- Create a layout for posts in `templates/layouts` and maybe name it something like `post.nunjucks`
- Create a function that compiles a list of all the posts and then loops over that list so that it would generate a page for each post, based on the `post.nunjucks` layout.
- The only thing is I'll probably need to create a page for this type of page under `templates/pages`, and name it `article.nunjucks`. Not sure yet on that or if using `post.nunjucks` will be enough

**About Frontmatter**
Found a few resources, a lot related to Jekyll (which I've never used) but I'm sure is useful in getting me to understand what is is and where it fits in.
- [SimplePrimate on YAML](http://simpleprimate.com/blog/front-matter)
- [Ethan Marcotte on YAML/Jekyll tricks](https://ethanmarcotte.com/wrote/stupid-jekyll-tricks/)
- [Jekyll on YAML](https://jekyllrb.com/docs/front-matter/)
- [Cuttlebelle on what is frontmatter](https://github.com/cuttlebelle/website/blob/master/content/documentation/what-is-frontmatter.md)
- [Cuttlebelle examples](https://cuttlebelle.github.io/website/)

Frontmatter is the data at the front/top of your document. It is typically enclosed between two lines with 3 dashes. Example:

```yaml
---
title: My page title
---
```

There are other formats for frontmatter including JavaScript, JSON.

```yaml
---json
{
  "title": "My page title"
}
---
## My first header

# or

---js
{
  title: "My page title",
  currentDate: function() {
    // You can have a JavaScript function here!
    return (new Date()).toLocaleString();
  }
}
---
```

This is an example of how frontmatter is processed:
```markdown
---
name: Derek Worthen
age: 127
contact:
  email: email@domain.com
  address: some location
pets:
  - cat
  - dog
  - bat
match: !!js/regexp /pattern/gim
run: !!js/function function() { }
---
Some Other content
```

Turns into:

```yaml
{
    name: 'Derek Worthen',
    age: 127,
    contact: { email: 'email@domain.com', address: 'some location' },
    pets: [ 'cat', 'dog', 'bat' ],
    match: /pattern/gim,
    run: [Function],
    __content: '\nSome Other Content'
}
```

So far I have a good understanding of the basics.
- Using a package/plugin like `gulp-gray-matter` or `yaml-front-matter` you can extract frontmatter from files, especially Markdown files.
- What I don't understand now is how you get that information back into the nunjucks/HTML page during the rendering process
- And how else or what else you're using it with

Luckily the `grey-matter` repo has some [tests](https://github.com/jonschlinkert/gray-matter) I'm going to have to try at some point.

StackOverflow has some answers!
- `gulp-nunjucks-render` and `gulp-grey-matter` both store/access data in the data property of each file that is piped through. [Source](https://stackoverflow.com/questions/36457216/how-do-i-access-the-data-object-created-by-the-gulp-gray-matter-plugin-when-com)


Good news is that I've got this working. Probably the easiest package installation ever! Now I need to figure out how to use the frontmatter to define layout. But that is not super important at this stage. **Update:** Figured out how to do that with variables, yay!

### Entry No. 005
Date: Thursday 03/28/2019

**Second Update:**
Soooo I figured it out and this is why I need to spend more time reading documentation (although sometimes it is not clear that that would've helped). I mean, none of my errors had anything to do with what I figured out.

So I went back to the drawing board and decided to see if I troubleshoot from the code that was working but not doing what I wanted. It was outputting actual HTML tags and not formatted text. I then realized that maybe I could figure out a way to change autoescaping, since it seemed like Nunjucks was escaping special characters and TADA.. that was it. I actually tried that previously but I wasn't adding the option to the `nunjucksRender` function correctly. Two days later, we've got the markdown and nunjucks working as I imagined.

Although I've got this working, I haven't figured out the why although I know it has something to do with `.bind` and `this`, thanks to [MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind).

I'm going to commit these changes. Wow what an eventful night.

**Update:**
I'm going to take a break. Just a little disappointed. Option 2 w/`gulp-nunjucks-render` is the closest I get to a working version of this. Otherwise, I think I'll have to not use these gulp nunjucks plugins.

**Notes:**
This should actually be entry no. 006 but I got really busy/exhausted trying to figure out how to get this markdown nunjucks thing to play well together. Decided to document all the fixes I've tried here for reference because right now I'm trying a lot.

A few things are happening: I'm getting an unknown block error or it doesn't compile the markdown to HTML at all, it renders as HTML tags.

1) [Unknown block tag error with gulp-nunjucks-render and nunjucks-markdown](https://github.com/zephraph/nunjucks-markdown/issues/25)
    - Tried this fix with `gulp-nunjucks-render` and `gulp-nunjucks-api`. The former renders `[object Object]` but no content from the markdown block, and no error. The latter returns an error like "Template render error: (/mnt/c/sgdi/www/myProjects/pink-lemonade/sans-base/src/templates/pages/index.nunjucks) [Line 8, Column 2]\n  unknown block tag: markdown\n"
    - I also try it with all of the versions of markdown I have installed: `markdown-it`, `gulp-markdownit`, and `gulp-markdown-it`
    - `markdown-it` gives an error of: "Error: Wrong `markdown-it` preset"

```js
var nunjucksRender = require('gulp-nunjucks-render');
// var nunjucksRender = require('gulp-nunjucks-api')
var markdown = require('nunjucks-markdown');
var markdownIt = require('markdown-it');
var gulpMarkdownIt = require('gulp-markdownit');
var gulpMdIt = require('gulp-markdown-it');

nunjucksMarkdownRender = function (env) {
    // const md = markdownIt().render.bind(markdownIt());
    // var md = new markdownIt();
    markdown.register(env, gulpMdIt);

}

// nunjucks compilation to html
gulp.task('nunjucks', function() {

    // gets .html & .nunjucks files in the directory, excludes files that start with an underscore ... globbing
    return gulp.src('src/templates/pages/[^_]*.+(nunjucks|html)')
    //renders files using the templates located in this directory. storing the template directories in an array allows the usage of just files names w/extends & includes
    .pipe(nunjucksRender({
        manageEnv: nunjucksMarkdownRender,
        path: [
            'src/templates/layouts', // the main template
            'src/templates/partials', // partials
            'src/templates/pages'], // pages that will be based on the main template & partials
    }))
    .on('error', gutil.log) // checks and logs errors
    //outputs the files into the src home folder
    .pipe(gulp.dest('src'))
    .pipe(browserSync.reload({stream: true}));
});

```
2) [Micro static site generator with in-markdown templating using Gulp & Nunjucks ](https://gist.github.com/seaneking/aef8db386a8415148517cebad505d877)
    - Tried this with `gulp-nunjucks-render` and it spits out the HTML tags onto the page. I get the block error again with `gulp-nunjucks-api`

```js
nunjucksMarkdownRender = function (env) {
    var md = markdownIt.render.bind(markdownIt);
    markdown.register(env, md);
// referenced my markdownIt variable
}
```

3)[Investigate problems with gulp-nunjucks-render](https://github.com/zephraph/nunjucks-markdown/issues/7)
    - Tried with `gulp-nunjucks-api` and `gulp-nunjucks-render` and got another unknown block error.

```js
gulp.task('nunjucks', function() {

    var env = nunjucksRender.nunjucks.configure('src/templates')
    markdown.register(env)

})
```
4) [Custom Gulp Markdown Setup] (https://gist.github.com/kerryhatcher/1382950af52f3082ecdc668bba5aa11b)
    - `gulp-nunjucks-render` & `gulp-nunjucks-api` spit out an unknown block error without compiling.

```js
var env = new nunjucksRender.nunjucks.Environment(new nunjucksRender.nunjucks.FileSystemLoader('src/templates/'));
markdown.register(env,markdownIt)
```

### Entry No. 004
Date: Tuesday 03/26/2019

**Notes:**
I'm back bishes! Again, hahaha. I actually took a trip and got sick and now I'm trying to pick up the pieces of my life for the last 3-4 weeks, but yes I'm still kicking.

I decided to sort through my bookmarks which led me to sorting through all the bookmarks I have related to creating a static site generator. I did that over the weekend while recovering from this mystery bug going around and I'm ready to get back into things. I think I may actually have to use my "online network" to work through my questions and any things keeping me stuck in this place of no progress.

I'm going to take a step back. Instead of focusing on how I'm going to pass in filenames for single page processing, I'm going to figure out how to process markdown. My current nunjucks setup only renders Nunjucks to HTML and I want it to render Nunjucks and Markdown to HTML. After I figure that out, I'll need to figure out how to incorporate frontmatter into the mix. This decision is PROGRESS. Decided on this after listening to a podcast that said one of the biggest mistakes people make with debugging is not isolating the problems. I flipped that and decided to isolate functionality to help me along with the project. Bite size progress.

I've seen the following markdown parsers mentioned but apparently there are more.
- Marked
- Markdown-It

Each parser has different features, apparently code blocks are not native to Markdown and a newer feature. Anyway, which parser I use for this project will now likely depend on what features it has built-in to help me. Some parsers have syntax for metadata and that would be awesome, a 2-for-1.

Anyway, I'm going to install the following packages and configure them, see what happens.


### Entry No. 003
Date: Thursday 02/07/2019

**Notes:**
I'm back bishes! So picking up where I left off when figuring out how to pass arguments from the command line into my gulp tasks. When I could not sleep last night I found some resources to help me strategize on how to make this happen. [Autumn Lansing](https://autumnlansing.com/articles/static-site-generators) had the same thought I did about compiling single pages instead of the entire site.

So far I've created a `test.js` file to _test_ my assumptions and code. I'm running it with `node test.js`.

Also some pseudocode here:

```javascript
// TO DO: nunjucks to html single page compilation | gulp page --page <file.ext>
gulp.task('page', function() {

    // grab the arguments & stores the position of --page in the array
    var argsIndex = process.argv.indexOf("--page");
    var args = process.argv.slice(3);
    console.log(args);
    console.log(argsIndex)
    console.log(process.argv);


    // count the number of arguments and if they're greater than 1, start looping through

    // check if the file exists in the directory

    // if it does exist, store the file/path in a variable

    // plug that variable into the task below


    // gets .nunjucks file(s) in the directory
    return gulp.src('src/templates/pages/[^_]*.+(nunjucks|html)')
    //renders files using the templates located in this directory
    .pipe(nunjucksRender({
        path: [
            'src/templates/layouts', // the main template
            'src/templates/partials', // partials
            'src/templates/pages'] // pages that will be based on the main template & partials
    })).on('error', gutil.log) // checks and logs errors
    //outputs the files into the src home folder
    .pipe(gulp.dest('src'))
    .pipe(browserSync.reload({stream: true}));
});

```


### Entry No. 002
Date: Wednesday 02/06/2019

**Notes:**
So I'm not sure if there is an actual use case for this but 2 "To Dos" I added to my gulp file are:

```javascript
// TO DO: nunjucks to html single page compilation

// TO DO: nunjucks and markdown to html compilation
```
In order to compile a single page, I will need to pass in an argument. So now I'm searching how to pass arguments into gulp tasks. I know I've done this before back when I took my General Assembly JavaScript course but I'm so rusty. It was during the Data Types lesson, week 3. Luckily I have notes, but they're not enough so I'm back to Google. I'm now thinking I should definitely do a real refresher course, so I can get my bearings.

In the course I had a file named `argv.js` and it included this code: `console.log(process.argv)`. If I type in `node argv.js` it will [return an array](https://stackoverflow.com/questions/22213980/could-someone-explain-what-process-argv-means-in-node-js-please) that includes the path to node and the path to my javascript file. If i type in `node argv.js love` the array will also include an array item `love`, in position 2 (because computers start counting from 0 and not 1). It's all coming back to me! I remember covering the topic of [Extracting command line arguments from Node.js using destructuring](https://humanwhocodes.com/blog/2018/10/extracting-command-line-arguments-nodejs/) with our instructor trying to explain the whole `...args` thing, which I didn't completely get it the time.

See below:
```bash
$ node argv.js love
[ '/home/badgirlkudo/.nvm/versions/node/v8.12.0/bin/node',
  '/mnt/c/sgdi/edu/GA-jsDC-5/js-dc-5/02-data-types/assignment/argv.js',
  'love' ]
```

Anyway, it is possible to pass arguments to gulp tasks. Exactly how should I do that?

Before I get into my task of figuring out how to pass arguments, I decided to actually test my current gulp nunjucks workflow. I needed to do this because my directory structure has slightly changed.

```
src
├── 404.html
├── index.html
└── templates
    ├── layouts
    │   └── main.nunjucks
    ├── pages
    │   ├── 404.nunjucks
    │   ├── _img.nunjucks
    │   ├── _test.nunjucks
    │   └── index.nunjucks
    ├── partials
    │   ├── footer.nunjucks
    │   └── header.nunjucks
    └── posts
        └── riri-sample.md
```

In testing, I discovered some errors (e.g. `Error: template not found`). I had a similar problem before but couldn't remember what. I did my Google due diligence (thank you Stackoverflow) and learned that it may be a good idea to store all my template directory paths in an [array](https://stackoverflow.com/questions/39766802/array-of-multiple-path-is-not-working-in-nunjucks-for-templates-and-partials?rq=1) for the compile config. In the past, I only use a single directory `src/templates/layout` and that is not the source of all my files, so nunjucks would be confused when it started looking for a file like `header.nunjucks`.

Now my testing for that part is done. Deciding if this is a good place to pause for the night... knowing I may not be able to pick this back up until next week :disappointed: .

I already copied over the `gulp nunjucks` function to a new one for my single page compilation task, so I can pick up later on that.


### Entry No. 001
Date: Wednesday 01/30/2019

**Notes:**
- So I've been doing a lot of reading up on how to spin up a custom static site generator. I've already got sometime simple up & running but would like to incorporate Markdown and a thing called Frontmatter. So I decided to read up on what [Frontmatter](https://www.scribendi.com/advice/front_matter.en.html) is and apparently it is the most basic information and originates from publishing. On the web it refers to metadata.
- Frontmatter is written in [YAML](https://learn.getgrav.org/advanced/yaml) which is a format for storing data. I wonder if [JSON](https://rhnh.net/2011/01/31/yaml-tutorial/) is also used for frontmatter. Found this [YAML Cookbook](https://yaml.org/YAML_for_ruby.html) site which may be useful at some point.
- I've been reading up on tutorials for creating your own SSG and found some great resources:
    - Build a static site in 40 lines w/NodeJS (https://www.webdevdrops.com/build-static-site-generator-nodejs-8969ebe34b22/). This example uses JSON!
    - [Building a SSG in Python](https://www.timo-zimmermann.de/2014/5/how-to-write-a-static-site-generator/)
    - [SSG as a Blog](https://www.bastibl.net/blogging-with-gulp/).This tutorial seems like a good starting point. Apparently I can set up a task for compiling posts separately from individual core pages of a site.
    - [Armadillo](https://snugug.com/musings/armadillo/) is another example and I'll study the code for pointers once I get started.
    - A [Github Gist](https://gist.github.com/seaneking/489a8928b61da46a55f7e2971d46d3d6) with a gulpfile.js worth exploring. And [another one](https://gist.github.com/aljopro/b104e52471abce17557ba10aa074a59a).
    - A[ gulp starter kit](https://github.com/skcript/skcript-gulp-starter/blob/master/README.md)
    - StackOverflow always has [gems on gems](https://stackoverflow.com/questions/35725543/a-gulp-workflow-with-markdown-and-nunjucks).


What I need this static site generator to do is (this pseudo code is inspired by [TheCodeBarbarian](http://thecodebarbarian.com/2015/02/06/static_site_generators)):
- [ ] Read Nunjucks files
- [ ] Read Markdown files
- [ ] Compile the Markdown files (with the Frontmatter) and insert them into the Nunjucks files
- [ ] Compile the Nunjucks files into HTML
- [ ] Clean up URLs

Packages to explore
- [gulp-nunjucks-md](https://www.npmjs.com/package/gulp-nunjucks-md)
